
[TOMB_Process_Json]

BREAK_ONLY_BEFORE = ^{

CHARSET = UTF-8

LINE_BREAKER = ^{

NO_BINARY_CHECK = true

SHOULD_LINEMERGE = false

TIME_PREFIX = CreationDate

category = Structured

description = TOMB Process module output

pulldown_type = true


# CONVERSIONS TO CIM COMPLIANCE:
FIELDALIAS-cs_creation_class_name = CSCreationClassName AS cs_creation_class_name
FIELDALIAS-workstation = CSName AS workstation
FIELDALIAS-caption = Caption AS caption
FIELDALIAS-command_line = CommandLine AS command_line
FIELDALIAS-creation_class_name = CreationClassName AS creation_class_name
FIELDALIAS-creation_date = CreationDate AS creation_date
FIELDALIAS-description = Description AS description
FIELDALIAS-execution_state = ExecutionState AS execution_state
FIELDALIAS-handle = Handle AS handle
FIELDALIAS-handle_count  = HandleCount AS handle_count
FIELDALIAS-handles = Handles AS handles
FIELDALIAS-install_date = InstallDate AS install_date
FIELDALIAS-max_working_set = MaximumWorkingSetSize AS max_working_set
FIELDALIAS-min_working_set = MinimumWorkingSetSize AS min_working_set
FIELDALIAS-process_name = Name AS process_name
FIELDALIAS-computer_name = PSComputerName AS computer_name
FIELDALIAS-page_faults = PageFaults AS page_faults
FIELDALIAS-page_file_usage = PageFileUsage AS page_file_usage
FIELDALIAS-parent_process_id = ParentProcessId AS parent_process_id
FIELDALIAS-peak_page_file_usage = PeakPageFileUsage AS peak_page_file_usage
FIELDALIAS-peak_virtual_size = PeakVirtualSize AS peak_virtual_size
FIELDALIAS-peak_working_set = PeakWorkingSetSize AS peak_working_set
FIELDALIAS-priority = Priority AS priority
FIELDALIAS-private_page_count = PrivatePageCount AS private_page_count
FIELDALIAS-process_id = ProcessId AS process_id
FIELDALIAS-process_name = ProcessName AS process_name
FIELDALIAS-quota_nonpaged_usage = QuotaNonPagedPoolUsage AS quota_nonpaged_usage
FIELDALIAS-quota_paged_usage = QuotaPagedPoolUsage AS quota_paged_usage
FIELDALIAS-quota_peak_nonpaged_usage = QuotaPeakNonPagedPoolUsage AS quota_peak_nonpaged_usage
FIELDALIAS-quota_peak_paged_usage = QuotaPeakPagedPoolUsage AS quota_peak_paged_usage
FIELDALIAS-status = Status AS status
FIELDALIAS-termination_date = TerminationDate AS termination_date
FIELDALIAS-thread_count = ThreadCount AS thread_count
FIELDALIAS-version = WindowsVersion AS version
# FIELD CONVERSIONS TO READABLE VALUES:
EVAL-CSCreationClassName = null
EVAL-CSName = null
EVAL-Caption = null
EVAL-CommandLine = null
EVAL-CreationClassName = null
EVAL-CreationDate = null
EVAL-Description = null
EVAL-ExecutionState = null
EVAL-Handle = null
EVAL-HandleCount = null
EVAL-Handles = null
EVAL-InstallDate = null
EVAL-MaximumWorkingSetSize = null
EVAL-MinimumWorkingSetSize = null
EVAL-Name = null
EVAL-PSComputerName = null
EVAL-PageFaults = null
EVAL-PageFileUsage = null
EVAL-ParentProcessId = null
EVAL-PeakPageFileUsage = null
EVAL-PeakVirtualSize = null
EVAL-PeakWorkingSetSize = null
EVAL-Priority = null
EVAL-PrivatePageCount = null
EVAL-ProcessId = null
EVAL-ProcessName = null
EVAL-QuotaNonPagedPoolUsage = null
EVAL-QuotaPagedPoolUsage = null
EVAL-QuotaPeakNonPagedPoolUsage = null
EVAL-QuotaPeakPagedPoolUsage = null
EVAL-Status = null
EVAL-TerminationDate = null
EVAL-ThreadCount = null
EVAL-WindowsVersion = null

[TOMB_Service_Json]

BREAK_ONLY_BEFORE = ^{

CHARSET = UTF-8

DATETIME_CONFIG = CURRENT

LINE_BREAKER = ^{

NO_BINARY_CHECK = true

SHOULD_LINEMERGE = false

category = Structured

description = TOMB Service module output

disabled = false

pulldown_type = true


# FIELD CONVERSIONS TO READABLE VALUES:
FIELDALIAS-accept_pause = AcceptPause AS accept_pause
FIELDALIAS-accept_stop = AcceptStop AS accept_stop
FIELDALIAS-caption = Caption AS caption
FIELDALIAS-check_point = CheckPoint AS check_point
FIELDALIAS-container = Container AS container
FIELDALIAS-creation_class_name = CreationClassName AS creation_class_name
FIELDALIAS-delayed_auto_start = DelayedAutoStart AS delayed_auto_start
FIELDALIAS-description = Description AS description
FIELDALIAS-desktop_interact = DesktopInteract AS desktop_interact
FIELDALIAS-display_name = DisplayName AS display_name
FIELDALIAS-error_control = ErrorControl AS error_control
FIELDALIAS-exit_code = ExitCode AS exit_code
FIELDALIAS-install_date = InstallDate AS install_date
FIELDALIAS-process_name = Name AS process_name
FIELDALIAS-computer_name = PSComputerName AS computer_name
FIELDALIAS-file_path = PathName AS file_path
FIELDALIAS-process_id = ProcessId AS process_id
FIELDALIAS-service_exit_code = ServiceSpecificExitCode AS service_exit_code
FIELDALIAS-service_type = ServiceType AS service_type
FIELDALIAS-site = Site AS site
FIELDALIAS-start_mode = StartMode AS start_mode
FIELDALIAS-parent_process_name = StartName AS parent_process_name
FIELDALIAS-started = Started AS started
FIELDALIAS-state = State AS state
FIELDALIAS-status = Status AS status
FIELDALIAS-system_creation_class = SystemCreationClassName AS system_creation_class
FIELDALIAS-workstation = SystemName AS workstation
FIELDALIAS-tag_id = TagId AS tag_id
FIELDALIAS-wait_hint = WaitHint AS wait_hint
# FIELD CONVERSIONS TO READABLE VALUES:
EVAL-AcceptPause = null
EVAL-AcceptStop = null
EVAL-Caption = null
EVAL-CheckPoint = null
EVAL-Container = null
EVAL-CreationClassName = null
EVAL-DelayedAutoStart = null
EVAL-DisplayName = null
EVAL-ErrorControl = null
EVAL-ExitCode = null
EVAL-InstallDate = null
EVAL-Name = null
EVAL-PSComputerName = null
EVAL-PSShowComputerName = null
EVAL-PathName = null
EVAL-ProcessId = null
EVAL-ServiceSpecificExitCode = null
EVAL-ServiceType = null
EVAL-Site = null
EVAL-StartMode = null
EVAL-StartName = null
EVAL-Started = null
EVAL-State = null
EVAL-Status = null
EVAL-SystemCreationClassName = null
EVAL-SystemName = null
EVAL-TagId = null
EVAL-WaitHint = null

[TOMB_EventLog_Json]

BREAK_ONLY_BEFORE = ^{

CHARSET = UTF-8

LINE_BREAKER = ^{

NO_BINARY_CHECK = true

SHOULD_LINEMERGE = false

TIME_PREFIX = TimeCreated

category = Structured

description = TOMB EventLog module output

disabled = false

pulldown_type = true
# CONVERSIONS TO CIM COMPLIANCE:
FIELDALIAS-event_id = id AS event_id
FIELDALIAS-access_list = AccessList AS access_list

FIELDALIAS-access_mask = AccessMask AS access_mask

FIELDALIAS-access_right = AccessRight AS access_right

FIELDALIAS-accesses = Accesses AS accesses

FIELDALIAS-account_expires = AccountExpires AS account_expires

FIELDALIAS-account_name = AccountName AS account_name

FIELDALIAS-allowed_logon_hours = LogonHours AS allowed_logon_hours

FIELDALIAS-allowed_to_delegate_to = AllowedToDelegateTo AS allowed_to_delegate_to

FIELDALIAS-app = PackageName AS app

FIELDALIAS-auth_package_name = AuthenticationPackageName AS auth_package_name

FIELDALIAS-command_line = CommandLine AS command_line

FIELDALIAS-computer_name = WorkstationName AS computer_name

FIELDALIAS-create_time = TimeCreated AS create_time

FIELDALIAS-display_name = DisplayName AS display_name

FIELDALIAS-dns_host_name = DnsHostName AS dns_host_name

FIELDALIAS-domain_name = DomainName AS domain_name

FIELDALIAS-domain_sid = DomainSid AS domain_sid

FIELDALIAS-elevated_privilege = ElevatedToken AS elevated_privilege

FIELDALIAS-failure_reason = FailureReason AS failure_reason

FIELDALIAS-group_domain = TargetDomainName AS group_domain

FIELDALIAS-group_name = TargetUserName AS group_name

FIELDALIAS-handle_id = HandleId AS handle_id

FIELDALIAS-home_directory = HomeDirectory AS home_directory

FIELDALIAS-home_drive = HomePath AS home_drive

FIELDALIAS-impersonation_level = ImpersonationLevel AS impersonation_level

FIELDALIAS-key_length = KeyLength AS key_length

FIELDALIAS-level = Level AS level

FIELDALIAS-logon_guid = LogonGuid AS logon_guid

FIELDALIAS-logon_process_name = LogonProcessName AS logon_process_name

FIELDALIAS-logon_status = LogonStatus AS logon_status

FIELDALIAS-logon_type = LogonType AS logon_type

FIELDALIAS-member_name = MemberName AS member_name

FIELDALIAS-member_sid = MemberSid AS member_sid

FIELDALIAS-new_reg_type = NewValueType AS new_reg_type

FIELDALIAS-new_reg_value = NewValue AS new_reg_value

FIELDALIAS-new_security_descriptor = NewSd AS new_security_descriptor

FIELDALIAS-new_uac_value = NewUacValue AS new_uac_value

FIELDALIAS-ntlm_protocol = LmPackageName AS ntlm_protocol

FIELDALIAS-object_name = ObjectName AS object_name

FIELDALIAS-object_server = ObjectServer AS object_server

FIELDALIAS-object_type = ObjectType AS object_type

FIELDALIAS-object_value_name = ObjectValueName AS object_value_name

FIELDALIAS-old_security_descr = OldSd AS old_security_descr

FIELDALIAS-old_uac_value = OldUacValue AS old_uac_value

FIELDALIAS-old_value = OldValue AS old_value

FIELDALIAS-old_value_type = OldValueType AS old_value_type

FIELDALIAS-operation_type = OperationType AS operation_type

FIELDALIAS-parent_file_name = ParentFileName AS parent_file_name

FIELDALIAS-password_last_set = PasswordLastSet AS password_last_set

FIELDALIAS-primary_group_id = PrimaryGroupId AS primary_group_id
FIELDALIAS-process_status = Status AS process_status

FIELDALIAS-profile_changed = ProfileChanged AS profile_changed

FIELDALIAS-profile_path = ProfilePath AS profile_path

FIELDALIAS-provider_name = ProviderName AS provider_name

FIELDALIAS-record_id = EventRecordID AS record_id

FIELDALIAS-restricted_admin_mode = RestrictedAdminMode AS restricted_admin_mode

FIELDALIAS-rule_id = RuleId AS rule_id

FIELDALIAS-rule_name = RuleName AS rule_name

FIELDALIAS-sam_account_name = SamAccountName AS sam_account_name

FIELDALIAS-scheduled_task_content = TaskContent AS scheduled_task_content

FIELDALIAS-scheduled_task_name = TaskName AS scheduled_task_name

FIELDALIAS-script_path = ScriptPath AS script_path

FIELDALIAS-service_account = ServiceAccount AS service_account

FIELDALIAS-service_file_path = ServiceFileName AS service_file_path

FIELDALIAS-service_name = ServiceName AS service_name

FIELDALIAS-service_principle_names = ServicePrincipleNames AS service_principle_names

FIELDALIAS-service_start_type = ServiceStartType AS service_start_type

FIELDALIAS-service_type = ServiceType AS service_type

FIELDALIAS-share_name = ShareName AS share_name

FIELDALIAS-share_path = ShareLocalPath AS share_path

FIELDALIAS-sid_filtering = SidFilteringEnabled AS sid_filtering

FIELDALIAS-sid_history = SidHistory AS sid_history

FIELDALIAS-src_ip = IpAddress AS src_ip

FIELDALIAS-src_port = IpPort AS src_port

FIELDALIAS-src_workstation = Workstation AS src_workstation

FIELDALIAS-subject_domain = SubjectDomainName AS subject_domain

FIELDALIAS-subject_logon_id = SubjectLogonId AS subject_logon_id

FIELDALIAS-subject_logon_process = SubjectLogonProcess AS subject_logon_process

FIELDALIAS-subject_logon_type = SubjectLogonType AS subject_logon_type

FIELDALIAS-subject_sid = SubjectUserSid AS subject_sid

FIELDALIAS-subject_user = SubjectUserName AS subject_user

FIELDALIAS-target_domain = TargetDomainName AS target_domain

FIELDALIAS-target_linked_logon_id = TargetLinkedLogonId AS target_linked_logon_id

FIELDALIAS-target_logon_id = TargetLogonId AS target_logon_id

FIELDALIAS-target_network_domain = TargetOutboundUserDomain AS target_network_domain

FIELDALIAS-target_network_user = TargetOutboundUserName AS target_network_user

FIELDALIAS-target_sid = TargetSid AS target_sid

FIELDALIAS-target_user = TargetUserName AS target_user

FIELDALIAS-token_elevation_type = TokenElevationType AS token_elevation_type

FIELDALIAS-transmitted_services = TransmittedServices AS transmitted_services

FIELDALIAS-trust_attributes = TdoAttributes AS trust_attributes

FIELDALIAS-trust_direction = TdoDirection AS trust_direction

FIELDALIAS-trust_type = TdoType AS trust_type

FIELDALIAS-user_account_control = UserAccountControl AS user_account_control

FIELDALIAS-user_parameters = UserParameters AS user_parameters

FIELDALIAS-user_principal_name = UserPrincipalName AS user_principal_name

FIELDALIAS-user_rights = PrivilegeList AS user_rights

FIELDALIAS-user_workstations = UserWorkstations AS user_workstations

FIELDALIAS-v_account = VirtualAccount AS v_account


FIELDALIAS-file_name = ProcessName AS file_name
FIELDALIAS-new_file_name = NewProcessName AS file_name
FIELDALIAS-caller_file_name = CallerProcessName AS file_name
FIELDALIAS-app_file_name = Application AS file_name
FIELDALIAS-image_file_name = ImagePath AS file_name
FIELDALIAS-parent_file_name = ParentProcessName AS parent_file_name
FIELDALIAS-parent_file_path = ParentProcessName AS parent_process_path
# FIELD CONVERSIONS TO READABLE VALUES:
EVAL-auth_level = if (EventID==5712, param12, null())

EVAL-auth_service = if (EventID==5712, param11, null())

EVAL-auth_status = if (EventID==4776, Status, null())

EVAL-install_type = if (EventID==7040, param4, null())

EVAL-interface_uuid = if (EventID==5712, param9, null())

EVAL-new_service_start_type = if (EventID==7040, param3, null())

EVAL-parent_process_id = to
EVAL-printer_name = if (EventID==1107, param1, null())
EVAL-process_id = tonumber(ProcessId,16)
EVAL-proto_seq = if (EventID==5712, param10, null())

EV
AL-remote_ip = if (EventID==5712, param7, null())

EVAL-remote_port = if (EventID==5712, param8, null())

EVAL-subject_name = if (EventID==5712, param2, null())

EVAL-service_state = if (EventID==7036, param2, null())

EVAL-times_repeated = if (EventID==7034, param2, null())

EVAL-user = coalesce(case(EventID==4688,SubjectDomainName + "\\" + SubjectUserName,EventID==4624,TargetDomainName + "\\" + TargetUserName),user)

EVAL-logon_id = coalesce(case(EventID==4688,SubjectLogonId,EventID==4624,TargetLogonId),logon_id)

EVAL-src_ip = coalesce(case(EventID==4624,IpAddress,EventID==5156,SourceAddress),src_ip)

EVAL-src = coalesce(case(EventID==4624,IpAddress,EventID==5156,SourceAddress),src)

EVAL-src_port = coalesce(case(EventID==4624,IpAddress,EventID==5156,SourceAddress),src_port)

EVAL-dest = coalesce(case(EventID==5156,DestAddress),dest)

EVAL-dest_ip = coalesce(case(EventID==5156,DestAddress),dest_ip)

EVAL-dest_port = coalesce(case(EventID==5156,DestPort),dest_port)
# SET ORIGINAL VALUES TO NULL, REMOVES NON CIM COMPLIANCE
EVAL-id = null
EVAL-AccessList = null
EVAL-AccessMask = null
EVAL-AccessRight = null
EVAL-Accesses = null
EVAL-AccountExpires = null
EVAL-AccountName = null
EVAL-LogonHours = null
EVAL-AllowedToDelegateTo = null
EVAL-PackageName = null
EVAL-AuthenticationPackageName = null
EVAL-CommandLine = null
EVAL-WorkstationName = null
EVAL-TimeCreated = null
EVAL-DisplayName = null
EVAL-DnsHostName = null
EVAL-DomainName = null
EVAL-DomainSid = null
EVAL-ElevatedToken = null
EVAL-FailureReason = null
EVAL-TargetDomainName = null
EVAL-TargetUserName = null
EVAL-HandleId = null
EVAL-HomeDirectory = null
EVAL-HomePath = null
EVAL-ImpersonationLevel = null
EVAL-KeyLength = null
EVAL-Level = null
EVAL-LogonGuid = null
EVAL-LogonProcessName = null
EVAL-LogonStatus = null
EVAL-LogonType = null
EVAL-MemberName = null
EVAL-MemberSid = null
EVAL-NewValueType = null
EVAL-NewValue = null
EVAL-NewSd = null
EVAL-NewUacValue = null
EVAL-LmPackageName = null
EVAL-ObjectName = null
EVAL-ObjectServer = null
EVAL-ObjectType = null
EVAL-ObjectValueName = null
EVAL-OldSd = null
EVAL-OldUacValue = null
EVAL-OldValue = null
EVAL-OldValueType = null
EVAL-OperationType = null
EVAL-ParentFileName = null
EVAL-PasswordLastSet = null
EVAL-PrimaryGroupId = null
EVAL-Status = null
EVAL-ProfileChanged = null
EVAL-ProfilePath = null
EVAL-ProviderName = null
EVAL-EventRecordID = null
EVAL-RestrictedAdminMode = null
EVAL-RuleId = null
EVAL-RuleName = null
EVAL-SamAccountName = null
EVAL-TaskContent = null
EVAL-TaskName = null
EVAL-ScriptPath = null
EVAL-ServiceAccount = null
EVAL-ServiceFileName = null
EVAL-ServiceName = null
EVAL-ServicePrincipleName = null
EVAL-ServiceStartType = null
EVAL-ServiceType = null
EVAL-ShareName = null
EVAL-ShareLocalPath = null
EVAL-SidFilteringEnabled = null
EVAL-SidHistory = null
EVAL-IpAddress = null
EVAL-IpPort = null
EVAL-SubjectDomainName = null
EVAL-SubjectLogonId = null
EVAL-SubjectLogonProcess = null
EVAL-SubjectLogonType = null
EVAL-SubjectUserSid = null
EVAL-SubjectUserName = null
EVAL-TargetDomainName = null
EVAL-TargetLinkedLogonId = null
EVAL-TargetLogonId = null
EVAL-TargetOutboundUserDomain = null
EVAL-TargetOutboundUserName = null
EVAL-TargetUserSid = null
EVAL-TargetUserName = null
EVAL-TokenElevationType = null
EVAL-TransmittedServices = null
EVAL-TdoAttributes = null
EVAL-TdoDirection = null
EVAL-TdoType = null
EVAL-UserAccountControl = null
EVAL-UserParameters = null
EVAL-UserPrincipalName = null
EVAL-PrivilegeList = null
EVAL-UserWorkstations = null
EVAL-VirtualAccount = null
EVAL-ProcessName = null
EVAL-NewProcessName = null
EVAL-CallerProcessName = null
EVAL-Application = null
EVAL-ImagePath = null
EVAL-ParentProcessName

[TOMB_Signatures_Json]

BREAK_ONLY_BEFORE = ^{

CHARSET = UTF-8

DATETIME_CONFIG = CURRENT

LINE_BREAKER = ([\r\n]+)

NO_BINARY_CHECK = true

SHOULD_LINEMERGE = false

category = Structured

description = TOMB Signatures module output

disabled = false

pulldown_type = true
EXTRACT-file_name = ^[^:\n]*:\s+(?P<file_name>[^,]+)

EXTRACT-signature = ^(?:[^ \n]* ){4}(?P<signature>[^,]+)

EXTRACT-vendor = ^(?:[^ \n]* ){6}(?P<vendor>[^,]+)

EXTRACT-status = ^(?:[^ \n]* ){9}(?P<status>[^,]+)
EXTRACT-sha1 = 
^(?:[^:\n]*:){6}\s+(?P<sha1>[^,]+)

EXTRACT-md5 = ^(?:[^:\n]*:){7}\s+(?P<md5>[^,]+)

EXTRACT-file_version = ^(?:[^:\n]*:){8}\s+(?P<file_version>\d+\.\d+\.\d+\.\d+\s+\(\w+\d+_\w+\.\d+\-\d+\))




[TOMB_SchedTask_Json]

BREAK_ONLY_BEFORE = ^{

CHARSET = UTF-8

DATETIME_CONFIG = CURRENT

LINE_BREAKER = ([\r\n]+)

NO_BINARY_CHECK = true

SHOULD_LINEMERGE = false

category = Structured

description = TOMB SchedTask module output

disabled = false

pulldown_type = true
# CONVERSIONS TO CIM COMPLIANCE:
FIELDALIAS-arguments = Arguments AS arguments
FIELDALIAS-author = Author AS author
FIELDALIAS-command_line = Command AS command_line
FIELDALIAS-description = Description AS description
FIELDALIAS-last_result = LastResult AS last_result
FIELDALIAS-last_run_time = LastRunTime AS last_run_time
FIELDALIAS-process_name = Name AS process_name
FIELDALIAS-next_run = NextRun AS next_run
FIELDALIAS-computer_name = PSComputerName AS computer_name
FIELDALIAS-file_path = Path AS file_path
FIELDALIAS-subject_user = RunAsUser AS subject_user
FIELDALIAS-workstation = Server AS workstation
FIELDALIAS-status = Status AS status
# SET ORIGINAL VALUES TO NULL, REMOVES NON CIM COMPLIANCE
EVAL-Arguments = null
EVAL-Author = null
EVAL-Command = null
EVAL-Description = null
EVAL-LastResult = null
EVAL-LastRunTime = null
EVAL-Name = null
EVAL-NextRun = null
EVAL-PSComputerName = null
EVAL-Path = null
EVAL-RunAsUser = null
EVAL-Server = null
EVAL-Status = null





[TOMB_Registry_Json]

BREAK_ONLY_BEFORE = ^{

CHARSET = UTF-8

DATETIME_CONFIG = CURRENT

LINE_BREAKER = ([\r\n]+)

NO_BINARY_CHECK = true

SHOULD_LINEMERGE = false

category = Structured

description = TOMB Registry module output

disabled = false

pulldown_type = true
